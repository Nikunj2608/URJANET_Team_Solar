/* Legacy layout & utility styles (reâ€‘introduced for diagnostic restore) */
html,body,#root { margin:0; padding:0; }

/* Basic grid wrapper previously used; ensure content is visible */
.grid-wrapper { display:flex; flex-direction:column; gap:18px; padding:14px 18px 40px; width:100%; box-sizing:border-box; }

.kpi-row { display:grid; grid-template-columns:repeat(auto-fit,minmax(140px,1fr)); gap:12px; }
.kpi { position:relative; background:rgba(255,255,255,0.04); border:1px solid rgba(255,255,255,0.08); border-radius:12px; padding:10px 12px 12px; backdrop-filter:blur(12px); box-shadow:0 4px 12px -4px rgba(0,0,0,0.5); font-size:0.55rem; letter-spacing:.5px; display:flex; flex-direction:column; gap:4px; }
.kpi .label { font-size:0.6rem; font-weight:600; opacity:.75; }
.kpi .delta { font-size:0.55rem; font-weight:600; opacity:.65; }
.kpi .delta.up { color:#2e8b57; }
.kpi .delta.down { color:#da3633; }
.kpi .delta.flat { color:#9ba6be; }

.grid { display:grid; width:100%; grid-template-columns:repeat(auto-fill,minmax(260px,1fr)); gap:16px; align-items:start; }

/* GlassCard fallback if theme not yet applied */
.glass-card { background:rgba(18,28,48,0.4); border:1px solid rgba(255,255,255,0.08); border-radius:16px; padding:16px; color:#f5f7fa; font-size:0.7rem; min-width:0; }

/* Scrollbar tweaks (non critical) */
::-webkit-scrollbar { width:8px; height:8px; }
::-webkit-scrollbar-thumb { background:rgba(255,255,255,0.15); border-radius:4px; }

/* Chat typing dots */
.typing-dots::after { content:""; display:inline-block; width:1em; text-align:left; animation:typingDots 1.1s infinite steps(4); }
@keyframes typingDots { 0% { content:""; } 25% { content:"."; } 50% { content:".."; } 75% { content:"..."; } 100% { content:""; } }

/* Simple fade-in class used in legacy markup */
.fade-in { animation:fadeIn .4s ease; }
@keyframes fadeIn { from { opacity:0; transform:translateY(6px); } to { opacity:1; transform:translateY(0); } }

/* Ensure body text color so blank screen still shows text */
body { background:#060a12; color:#f5f7fa; font-family:Inter,system-ui,sans-serif; }
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');

:root {
  --font-stack: 'Inter', system-ui, Arial, sans-serif;
  --bg: #0d1117;
  --bg-alt: #161b22;
  --bg-accent: #1f2630;
  --border: #30363d;
  --text: #e6edf3;
  --text-dim: #9ea7b3;
  --primary: #58a6ff;
  --primary-glow: 90,168,255;
  --danger: #da3633;
  --warn: #f0883e;
  --ok: #238636;
  --radius-sm: 4px;
  --radius: 8px;
  --shadow: 0 4px 8px rgba(0,0,0,0.4), 0 6px 24px -6px rgba(0,0,0,0.55);
  --focus: 0 0 0 2px rgba(var(--primary-glow),0.4);
  --gradient-accent: linear-gradient(135deg,#252b33,#1d232b);
  --severity-high: #ff4d4f;
  --severity-medium: #ffb347;
  --severity-low: #4da3ff;
  --severity-healthy: #2ecc71;
}

[data-theme='light'] {
  --bg: #f5f7fa;
  --bg-alt: #ffffff;
  --bg-accent: #eef1f5;
  --border: #d0d7de;
  --text: #1f2328;
  --text-dim: #57606a;
  --shadow: 0 2px 4px rgba(0,0,0,0.08), 0 4px 16px -4px rgba(0,0,0,0.08);
  --gradient-accent: linear-gradient(135deg,#f0f3f7,#e6eaef);
}

* { box-sizing: border-box; }
html, body { height: 100%; }
body { margin:0; font-family: var(--font-stack); background: var(--bg); color: var(--text); -webkit-font-smoothing: antialiased; }

#app-shell { min-height:100vh; display:flex; flex-direction:column; }

.topbar { display:flex; align-items:center; gap:16px; padding:10px 24px; background:linear-gradient(90deg,#111822,#18212c); border-bottom:1px solid var(--border); position:sticky; top:0; z-index:15; }
.topbar h1 { font-size:1.05rem; margin:0; font-weight:600; letter-spacing:0.5px; display:flex; align-items:center; gap:6px; }
.topbar .spacer { flex:1; }

button, .btn { font-family:inherit; cursor:pointer; border:1px solid var(--border); background:var(--bg-accent); color:var(--text); padding:6px 12px; font-size:0.72rem; font-weight:500; border-radius:var(--radius-sm); display:inline-flex; align-items:center; gap:6px; line-height:1; transition:.18s background, .18s border-color, .18s color, .18s transform; }
button:hover, .btn:hover { background:var(--bg-alt); transform:translateY(-1px); }
button:hover, .btn:hover { background:var(--bg-alt); }
button:focus-visible { outline:none; box-shadow: var(--focus); }
button[disabled] { opacity:0.4; cursor:default; }

.grid-wrapper { width:100%; max-width:1600px; margin:0 auto; padding:18px 20px 40px; flex:1; }
.grid { display:grid; gap:18px; grid-template-columns: repeat(auto-fit,minmax(320px,1fr)); }

.card { position:relative; background:var(--gradient-accent); border:1px solid var(--border); border-radius:var(--radius); padding:16px 16px 18px; box-shadow:var(--shadow); overflow:hidden; backdrop-filter: blur(4px); }
.card h2 { margin:0 0 10px; font-size:0.95rem; font-weight:600; letter-spacing:.5px; display:flex; align-items:center; gap:6px; }
.kpi-row { display:grid; gap:14px; grid-template-columns: repeat(auto-fit,minmax(160px,1fr)); margin-bottom:18px; }
.kpi { background:var(--bg-accent); border:1px solid var(--border); border-radius:10px; padding:10px 12px 12px; display:flex; flex-direction:column; gap:4px; position:relative; overflow:hidden; }
.kpi::after { content:""; position:absolute; inset:0; background:radial-gradient(circle at 120% 0%, rgba(var(--primary-glow),0.08), transparent 60%); pointer-events:none; }
.kpi .label { font-size:0.55rem; letter-spacing:1px; font-weight:600; text-transform:uppercase; color:var(--text-dim); }
.kpi .value { font-size:1.05rem; font-weight:600; letter-spacing:.5px; display:flex; align-items:baseline; gap:6px; }
.kpi .delta { font-size:0.6rem; font-weight:600; display:inline-flex; align-items:center; gap:3px; }
.delta.up { color:var(--ok); }
.delta.down { color:var(--danger); }
.delta.flat { color:var(--text-dim); }
.kpi small.unit { font-size:0.6rem; color:var(--text-dim); }

.env-badge { background:var(--bg-accent); border:1px solid var(--border); font-size:0.55rem; padding:4px 8px; border-radius:999px; letter-spacing:.75px; font-weight:600; display:inline-flex; align-items:center; gap:4px; }

.device-select { background:var(--bg-accent); border:1px solid var(--border); color:var(--text); border-radius:6px; font-size:0.7rem; padding:6px 8px; }
select:focus-visible { outline:none; box-shadow:var(--focus); }

.skeleton { position:relative; background:linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.07), rgba(255,255,255,0.02)); background-size:200% 100%; animation: shimmer 1.4s linear infinite; border-radius:6px; }
@keyframes shimmer { from { background-position:0 0;} to { background-position: -200% 0;} }

.chart-axes { position:absolute; inset:0; pointer-events:none; font-size:0.5rem; color:var(--text-dim); }
.chart-axes .y-label { position:absolute; left:4px; }
.chart-axes .x-labels { position:absolute; bottom:0; left:0; right:0; display:flex; justify-content:space-between; padding:0 4px 2px; }

.legend-inline { display:flex; gap:10px; flex-wrap:wrap; font-size:0.55rem; margin-top:6px; }
.legend-inline span { display:inline-flex; align-items:center; gap:4px; }
.legend-swatch { width:10px; height:10px; border-radius:2px; }
.card.small { padding:12px 14px; }

.subtle { color:var(--text-dim); font-size:0.65rem; letter-spacing:.5px; text-transform:uppercase; }
.muted { color:var(--text-dim); }
.flex { display:flex; }
.col { display:flex; flex-direction:column; }
.gap-xs { gap:4px; }
.gap-sm { gap:8px; }
.gap { gap:14px; }
.wrap { flex-wrap:wrap; }
.inline { display:inline-flex; align-items:center; }

.sep-h { height:1px; background:var(--border); margin:12px 0; }

ul { list-style:none; padding:0; margin:0; }
.alert-list { max-height:260px; overflow:auto; scrollbar-width:thin; scrollbar-color:var(--border) transparent; }
.alert-list li { padding:8px 6px 10px; border-bottom:1px solid var(--border); font-size:0.7rem; line-height:1.25; position:relative; }
.alert-list li:last-child { border-bottom:none; }

.severity { font-weight:600; font-size:0.55rem; padding:2px 6px 3px; border-radius:999px; display:inline-block; letter-spacing:0.5px; }
.sev-HIGH { background: var(--danger); color:#fff; }
.sev-LOW { background: var(--severity-low); color:#111; }
.sev-MEDIUM { background: var(--severity-medium); color:#111; }
.sev-RISK { background: #d97706; color:#111; }

.badge-outline { border:1px solid var(--border); padding:2px 6px; border-radius:4px; font-size:0.55rem; }
.badge { background:var(--bg-accent); border:1px solid var(--border); padding:2px 6px; border-radius:4px; font-size:0.55rem; }

canvas { width:100%; height:210px; display:block; }
.sparkline { width:100%; height:40px; }

.gauge { display:flex; flex-direction:column; align-items:center; }
.gauge-circle { width:170px; height:170px; border-radius:50%; position:relative; display:flex; align-items:center; justify-content:center; background:conic-gradient(var(--primary) var(--pct), #2d333b var(--pct)); box-shadow: inset 0 0 6px rgba(0,0,0,0.6); }
.gauge-circle span { position:absolute; font-size:1.55rem; font-weight:600; letter-spacing:1px; }

.footer { text-align:center; padding:14px 10px 26px; font-size:0.6rem; color:var(--text-dim); }

.status-bar { display:flex; gap:10px; flex-wrap:wrap; font-size:0.6rem; margin-top:8px; }
.status-pill { background:var(--bg-accent); padding:4px 8px; border-radius:100px; border:1px solid var(--border); display:inline-flex; align-items:center; gap:4px; }
.status-pill strong { font-weight:600; }

.theme-toggle { width:34px; height:20px; border-radius:20px; position:relative; background:var(--bg-accent); border:1px solid var(--border); cursor:pointer; }
.theme-toggle span { position:absolute; top:1px; left:1px; width:16px; height:16px; background:var(--primary); border-radius:50%; transition:.25s transform; }
[data-theme='light'] .theme-toggle span { transform:translateX(14px); }

@media (min-width: 1680px) {
  .grid { grid-template-columns: repeat(auto-fit,minmax(360px,1fr)); }
}

.fade-in { animation:fade .35s ease; }
@keyframes fade { from { opacity:0; transform:translateY(4px); } to { opacity:1; transform:translateY(0); } }

::-webkit-scrollbar { width:10px; height:10px; }
::-webkit-scrollbar-track { background:transparent; }
::-webkit-scrollbar-thumb { background:var(--bg-accent); border:2px solid transparent; background-clip:content-box; border-radius:10px; }
::-webkit-scrollbar-thumb:hover { background:var(--primary); border:2px solid var(--bg); }

/* Energetic additions & overrides */
:root {
  --accent-1: #ff6b6b;
  --accent-2: #ffb347;
  --accent-3: #7dd87d;
  --accent-4: #8b78ff;
  --gradient-energy: linear-gradient(135deg,#132533,#112a3d 40%,#0f202e);
  --gradient-kpi-voltage: linear-gradient(135deg,#224b86,#1d3352);
  --gradient-kpi-temp: linear-gradient(135deg,#864522,#522c1d);
  --gradient-kpi-soc: linear-gradient(135deg,#1e6232,#144a16);
  --gradient-kpi-alerts: linear-gradient(135deg,#6b1f1f,#441212);
}
.kpi.voltage { background:var(--gradient-kpi-voltage); }
.kpi.temperature { background:var(--gradient-kpi-temp); }
.kpi.soc { background:var(--gradient-kpi-soc); }
.kpi.alerts { background:var(--gradient-kpi-alerts); }
.card.energy { background:var(--gradient-energy); }

/* Dense mode overrides appended */
[data-density='dense'] .kpi-row { gap:10px; }
[data-density='dense'] .kpi { padding:10px 10px 11px; min-height:78px; }
[data-density='dense'] .kpi .value { font-size:1rem; }
[data-density='dense'] button { padding:4px 8px; font-size:0.65rem; }
[data-density='dense'] .card { padding:12px 14px 14px; }
[data-density='dense'] .gauge-circle { width:140px; height:140px; }
[data-density='dense'] .topbar { padding:8px 18px; }
[data-density='dense'] .status-pill { padding:3px 6px; }
[data-density='dense'] .env-badge { padding:3px 6px; }
